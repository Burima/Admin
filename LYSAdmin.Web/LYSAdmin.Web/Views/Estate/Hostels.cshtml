@using LYSAdmin.Model;
@using Newtonsoft.Json;
@using LYSAdmin.Web.Services.Common;
@model LYSAdmin.Model.PGDetailsViewModel

@{
    ViewBag.Title = "Hostels";
    //initialize AreaID
    var AreaID = Session["AreaID"] != null ? Convert.ToInt32(Session["AreaID"]) : 0;
    //get all the Areas from Application Variable
    var Areas = System.Web.HttpContext.Current.Application["Areas"] as List<Area>;
    //type of operation to be done(e.g. view,add)
    
    //storing current user session
    var User = (User)Session["User"];

    var showMessage = TempData["Message"] != null ? true : false;
    var CityName = Session["CityName"] != null ? Convert.ToString(Session["CityName"]) : String.Empty;
    var AreaName = Session["AreaName"] != null ? Convert.ToString(Session["AreaName"]) : String.Empty;

}

<!-- Datatable Css-->
@Styles.Render("~/Content/plugins/dataTables/dataTablesStyles")
<link href='@Url.Content("~/Content/Custom/Hostel.css")' rel="stylesheet" />

@if (TempData["Message"] != null)
{
    <div class="modal inmodal fade in" id="modalShowMessage" tabindex="-1" role="dialog" aria-hidden="false" style="display: block;">
        <div class="modal-dialog modal-sm">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Close</span></button>
                    <h4 class="modal-title">Message</h4>
                </div>
                <div class="modal-body">
                    <p>
                        @TempData["Message"]
                    </p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary center-block" data-dismiss="modal">Done</button>
                </div>
            </div>
        </div>
    </div>
}

<div class="modal inmodal" id="modalSelectCityAndArea" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content animated bounceInRight">
            <div class="modal-header">
                <h4 class="modal-title">Select Location</h4>

            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>City</label>
                    <select id="ddlCity" name="CityID" class="form-control">
                        <option value="" disabled selected>Select City</option>
                        @foreach (var city in System.Web.HttpContext.Current.Application["Cities"] as IList<City>)
                        {

                            <option value="@city.CityID">@city.CityName</option>
                        }
                    </select>

                </div>
                <div id="divArea" class="form-group hidden">
                    <label>Area</label>
                    <select id="ddlArea" name="AreaID" class="form-control"></select>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" id="btnSaveLocation">Save changes</button>
            </div>
        </div>
    </div>
</div>

@if (Session["AreaID"] != null)
{
    <div class="wrapper wrapper-content animated fadeInRight" id="divHostels" style="display:none">
        <div class="row">
            <div class="col-lg-12">
                <div class="ibox float-e-margins">
                    <div class="ibox-title">
                        <h5>PG/Hostels</h5>
                        <button class="btn btn-primary pull-right btn-show-add-hostel" type="button" style="margin-top:-1%;">Add</button>
                    </div>
                    <div class="ibox-content">

                        <table class="table table-striped table-bordered table-hover dataTables-hostels">
                            <thead>
                                <tr>
                                    <th>PG/Hostel Name</th>
                                    <th>Description</th>
                                    <th>Address</th>
                                    <th>Landmark</th>
                                    <th>Add Apartments</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody>
                                @if (Model != null && Model.PGDetails != null && Model.PGDetails.Count > 0)
                                {
                                    foreach (var pgDetail in Model.PGDetails)
                                    {
                                        <tr class="gradeX" id="@pgDetail.PGDetailID">
                                            <td><a onclick="fnGetHostelByID(this)" style="cursor:pointer;">@pgDetail.PGName</a></td>
                                            <td>@pgDetail.Description</td>
                                            <td>@pgDetail.Address</td>
                                            <td>@pgDetail.Landmark</td>
                                            <td>
                                                <a class="btn" href="@Url.Action("Houses", "Estate", new { operation = "Add" })">Add House</a>
                                            </td>
                                            <td><input type="button" class="btnDeleteApartment" value="Delete"></td>
                                        </tr>
                                    }
                                }
                            </tbody>
                            <tfoot>
                                <tr>
                                    <th>PG/Hostel Name</th>
                                    <th>Description</th>
                                    <th>Address</th>
                                    <th>Landmark</th>
                                    <th>Add Apartments</th>
                                    <th>Action</th>
                                </tr>
                            </tfoot>
                        </table>

                    </div>
                </div>
            </div>
        </div>

    </div>

    <div class="row  border-bottom white-bg dashboard-header" style="display:none;" id="divAddHostel">
        @Html.Partial("_AddHostel", Model)
    </div>
    <div class="row  border-bottom white-bg dashboard-header" style="display:none;" id="divEditHostel">
        @Html.Partial("_EditHostel")
    </div>

}
@section scripts{

    <script>
    //storing AreaID and all Areas in javascript variable
    var AreaID = '@AreaID';
    var Areas = '@Html.Raw(Json.Encode(Areas))';

    //reference url
    var HostelsUrl = '@Url.Action("Hostels","Estate")';
    var AddApartmentUrl = '@Url.Action("AddHostel", "Estate")';
    var GetHostelByIDUrl = '@Url.Action("GetHostelByID", "Estate")';
    var EditApartmentUrl = '@Url.Action("EditHostel", "Estate")';
    var DeleteApartmentUrl = '@Url.Action("DeleteApartment", "Estate")';
    var SaveBlocskUrl = '@Url.Action("SaveBlocks", "Estate")';
    //updating location
    var UpdateLocationUrl = '@Url.Action("UpdateLocation", "Estate")';

        var showMessage = '@showMessage';

        var cityname = '@CityName';
        var areaname = '@AreaName';
    </script>

    <!-- jQuery DataTable -->
    @Scripts.Render("~/plugins/dataTables")
   <script src="http://maps.googleapis.com/maps/api/js?libraries=geometry&amp;libraries=places" type="text/javascript"></script>
    <!--Custom Script for Apartment-->
    <script src='@Url.Content("~/Scripts/Custom/Hostel.js")'></script>
}
